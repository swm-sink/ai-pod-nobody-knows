{
  "$schema": "https://json-schema.org/draft/2025-08/schema",
  "$id": "https://ai-podcasts-nobody-knows.com/schemas/base-agent-response.json",
  "title": "Base Agent Response Schema",
  "description": "Core schema that all AI podcast production agents must conform to for system integration",
  "type": "object",
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version following semantic versioning",
      "examples": ["1.0.0"]
    },
    "agent_metadata": {
      "type": "object",
      "properties": {
        "agent_id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*[a-z0-9]$",
          "description": "Unique agent identifier matching agent file name",
          "examples": ["research-orchestrator-enhanced", "quality-claude-enhanced"]
        },
        "agent_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Agent version following semantic versioning",
          "examples": ["2.0.0"]
        },
        "execution_timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when agent completed execution"
        },
        "session_id": {
          "type": "string",
          "pattern": "^[a-z_]+_\\d{8}_\\d{6}$",
          "description": "Unique session identifier for execution tracking",
          "examples": ["research_session_20250822_153000"]
        },
        "episode_context": {
          "type": "object",
          "properties": {
            "topic": {
              "type": "string",
              "minLength": 1,
              "description": "Episode topic or title"
            },
            "script_version": {
              "type": "string",
              "pattern": "^v\\d+\\.\\d+\\.\\d+$",
              "description": "Script version being processed",
              "examples": ["v1.2.3"]
            },
            "episode_number": {
              "type": "integer",
              "minimum": 1,
              "description": "Episode number in series"
            },
            "target_duration": {
              "type": "string",
              "pattern": "^\\d+(-\\d+)?_minutes$",
              "description": "Target episode duration",
              "examples": ["25-30_minutes", "47_minutes"]
            }
          },
          "required": ["topic", "script_version"],
          "additionalProperties": false
        }
      },
      "required": ["agent_id", "agent_version", "execution_timestamp", "session_id", "episode_context"],
      "additionalProperties": false
    },
    "cost_tracking": {
      "type": "object",
      "properties": {
        "execution_cost": {
          "type": "number",
          "minimum": 0,
          "description": "Cost in USD for this agent execution"
        },
        "token_usage": {
          "type": "object",
          "properties": {
            "input_tokens": {
              "type": "integer",
              "minimum": 0
            },
            "output_tokens": {
              "type": "integer",
              "minimum": 0
            },
            "total_tokens": {
              "type": "integer",
              "minimum": 0
            }
          },
          "required": ["input_tokens", "output_tokens", "total_tokens"],
          "additionalProperties": false
        },
        "budget_status": {
          "type": "object",
          "properties": {
            "episode_budget_remaining": {
              "type": "number",
              "minimum": 0,
              "description": "Remaining budget for episode in USD"
            },
            "phase_allocation": {
              "type": "number",
              "minimum": 0,
              "description": "Budget allocated for this phase in USD"
            },
            "optimization_applied": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "prompt_optimization",
                  "semantic_caching",
                  "batch_processing",
                  "template_optimization",
                  "technical_pattern_caching",
                  "targeted_query_optimization",
                  "research_pattern_caching"
                ]
              },
              "description": "Cost optimization strategies applied during execution"
            }
          },
          "required": ["episode_budget_remaining", "phase_allocation", "optimization_applied"],
          "additionalProperties": false
        }
      },
      "required": ["execution_cost", "token_usage", "budget_status"],
      "additionalProperties": false
    },
    "execution_status": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "enum": ["completed", "completed_with_warnings", "failed", "partial_completion"],
          "description": "Overall execution status"
        },
        "confidence_level": {
          "type": "string",
          "enum": ["high", "medium", "low"],
          "description": "Agent confidence in execution results"
        },
        "execution_duration": {
          "type": "number",
          "minimum": 0,
          "description": "Execution time in seconds"
        },
        "warnings": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "warning_id": {
                "type": "string"
              },
              "category": {
                "type": "string",
                "enum": ["cost", "quality", "performance", "integration"]
              },
              "message": {
                "type": "string"
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high"]
              }
            },
            "required": ["warning_id", "category", "message", "severity"],
            "additionalProperties": false
          },
          "description": "Non-fatal issues encountered during execution"
        },
        "errors": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "error_id": {
                "type": "string"
              },
              "category": {
                "type": "string",
                "enum": ["api_failure", "validation_error", "resource_exhaustion", "timeout"]
              },
              "message": {
                "type": "string"
              },
              "recovery_attempted": {
                "type": "boolean"
              },
              "recovery_success": {
                "type": "boolean"
              }
            },
            "required": ["error_id", "category", "message", "recovery_attempted"],
            "additionalProperties": false
          },
          "description": "Errors encountered during execution"
        }
      },
      "required": ["status", "confidence_level", "execution_duration"],
      "additionalProperties": false
    }
  },
  "required": ["schema_version", "agent_metadata", "cost_tracking", "execution_status"],
  "additionalProperties": true
}
