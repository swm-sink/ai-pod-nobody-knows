{
  "$schema": "https://json-schema.org/draft/2025-08/schema",
  "$id": "https://ai-podcasts-nobody-knows.com/schemas/research-agent-response.json",
  "title": "Research Agent Response Schema",
  "description": "Schema for research stream agents (research-orchestrator, deep-research-agent) responses",
  "allOf": [
    {
      "$ref": "./base-agent-response.json"
    }
  ],
  "properties": {
    "research_methodology": {
      "type": "object",
      "properties": {
        "research_strategy": {
          "type": "string",
          "enum": [
            "multi_stage_perplexity_research",
            "sonar_deep_research_integration",
            "cross_domain_synthesis",
            "expert_interview_simulation",
            "source_triangulation"
          ],
          "description": "Primary research methodology applied"
        },
        "query_optimization": {
          "type": "object",
          "properties": {
            "total_queries": {
              "type": "integer",
              "minimum": 0
            },
            "successful_queries": {
              "type": "integer",
              "minimum": 0
            },
            "failed_queries": {
              "type": "integer",
              "minimum": 0
            },
            "query_cost": {
              "type": "number",
              "minimum": 0,
              "description": "Total cost of research queries in USD"
            },
            "optimization_applied": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "targeted_query_optimization",
                  "research_pattern_caching",
                  "batch_research_validation",
                  "multi_round_strategy",
                  "semantic_similarity_matching"
                ]
              }
            }
          },
          "required": ["total_queries", "successful_queries", "failed_queries", "query_cost", "optimization_applied"],
          "additionalProperties": false
        },
        "source_validation": {
          "type": "object",
          "properties": {
            "authoritative_sources": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of authoritative sources identified"
            },
            "peer_reviewed_sources": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of peer-reviewed sources"
            },
            "expert_sources": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of expert interviews or quotes"
            },
            "currency_validated": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of sources validated for currency"
            },
            "cross_referenced": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of facts cross-referenced across sources"
            }
          },
          "required": ["authoritative_sources", "peer_reviewed_sources", "expert_sources", "currency_validated", "cross_referenced"],
          "additionalProperties": false
        }
      },
      "required": ["research_strategy", "query_optimization", "source_validation"],
      "additionalProperties": false
    },
    "research_findings": {
      "type": "object",
      "properties": {
        "key_insights": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "insight_id": {
                "type": "string",
                "pattern": "^insight_\\d{3}$"
              },
              "category": {
                "type": "string",
                "enum": [
                  "foundational_concept",
                  "recent_development",
                  "expert_perspective",
                  "statistical_evidence",
                  "historical_context",
                  "future_implications"
                ]
              },
              "description": {
                "type": "string",
                "minLength": 1
              },
              "significance": {
                "type": "string",
                "enum": ["high", "medium", "low"]
              },
              "source_authority": {
                "type": "string",
                "enum": ["authoritative", "credible", "emerging", "unverified"]
              },
              "supporting_sources": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1
              }
            },
            "required": ["insight_id", "category", "description", "significance", "source_authority", "supporting_sources"],
            "additionalProperties": false
          },
          "minItems": 1
        },
        "expert_perspectives": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "expert_id": {
                "type": "string",
                "pattern": "^expert_\\d{3}$"
              },
              "expert_name": {
                "type": "string",
                "minLength": 1
              },
              "credentials": {
                "type": "string",
                "minLength": 1
              },
              "affiliation": {
                "type": "string",
                "minLength": 1
              },
              "expertise_area": {
                "type": "string",
                "minLength": 1
              },
              "perspective_summary": {
                "type": "string",
                "minLength": 1
              },
              "quote_verified": {
                "type": "boolean"
              },
              "authority_level": {
                "type": "string",
                "enum": ["leading_authority", "recognized_expert", "emerging_voice", "controversial"]
              }
            },
            "required": ["expert_id", "expert_name", "credentials", "affiliation", "expertise_area", "perspective_summary", "quote_verified", "authority_level"],
            "additionalProperties": false
          }
        },
        "research_gaps": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "gap_id": {
                "type": "string",
                "pattern": "^gap_\\d{3}$"
              },
              "description": {
                "type": "string",
                "minLength": 1
              },
              "impact": {
                "type": "string",
                "enum": ["critical", "important", "minor"]
              },
              "mitigation_strategy": {
                "type": "string",
                "minLength": 1
              }
            },
            "required": ["gap_id", "description", "impact", "mitigation_strategy"],
            "additionalProperties": false
          }
        }
      },
      "required": ["key_insights", "expert_perspectives", "research_gaps"],
      "additionalProperties": false
    },
    "quality_assurance": {
      "type": "object",
      "properties": {
        "fact_verification_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in fact verification accuracy"
        },
        "source_credibility_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Overall source credibility assessment"
        },
        "currency_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Information currency and relevance score"
        },
        "cross_validation_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Cross-source validation confidence"
        },
        "research_completeness": {
          "type": "string",
          "enum": ["comprehensive", "adequate", "limited", "insufficient"],
          "description": "Assessment of research thoroughness"
        },
        "uncertainty_areas": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "area": {
                "type": "string",
                "minLength": 1
              },
              "uncertainty_level": {
                "type": "string",
                "enum": ["high", "medium", "low"]
              },
              "expert_disagreement": {
                "type": "boolean"
              },
              "additional_research_needed": {
                "type": "boolean"
              }
            },
            "required": ["area", "uncertainty_level", "expert_disagreement", "additional_research_needed"],
            "additionalProperties": false
          }
        }
      },
      "required": ["fact_verification_score", "source_credibility_score", "currency_score", "cross_validation_score", "research_completeness", "uncertainty_areas"],
      "additionalProperties": false
    },
    "production_handoff": {
      "type": "object",
      "properties": {
        "research_package_status": {
          "type": "string",
          "enum": ["complete", "complete_with_gaps", "incomplete", "requires_additional_research"],
          "description": "Status of research for production use"
        },
        "narrative_structure_guidance": {
          "type": "object",
          "properties": {
            "recommended_flow": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Recommended narrative flow based on research"
            },
            "complexity_considerations": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Areas requiring careful complexity management"
            },
            "engagement_opportunities": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Research elements with high engagement potential"
            }
          },
          "required": ["recommended_flow", "complexity_considerations", "engagement_opportunities"],
          "additionalProperties": false
        },
        "brand_voice_integration": {
          "type": "object",
          "properties": {
            "intellectual_humility_opportunities": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Research areas highlighting intellectual humility"
            },
            "uncertainty_celebration": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Areas where uncertainty can be celebrated"
            },
            "expert_humanity": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "description": "Examples of expert humanity and fallibility"
            }
          },
          "required": ["intellectual_humility_opportunities", "uncertainty_celebration", "expert_humanity"],
          "additionalProperties": false
        },
        "cross_episode_connections": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "episode_reference": {
                "type": "string",
                "minLength": 1
              },
              "connection_type": {
                "type": "string",
                "enum": ["builds_on", "contrasts_with", "complements", "updates"]
              },
              "integration_opportunity": {
                "type": "string",
                "minLength": 1
              }
            },
            "required": ["episode_reference", "connection_type", "integration_opportunity"],
            "additionalProperties": false
          }
        }
      },
      "required": ["research_package_status", "narrative_structure_guidance", "brand_voice_integration", "cross_episode_connections"],
      "additionalProperties": false
    }
  },
  "required": ["research_methodology", "research_findings", "quality_assurance", "production_handoff"],
  "additionalProperties": false
}
